---

type Props = {
    audioUrl: string;
    slug: string;
};

const { audioUrl, slug }: Props = Astro.props;

---

<style>
  .audio-player {
    display: block;
    margin: auto auto 2em;
    width: 90%;
  }
</style>

<script>
  /** global umami */
  const audioPlayer = document.querySelector('.audio-player');
  if (audioPlayer) {
    const audioSlug = audioPlayer.getAttribute('data-slug');
    audioPlayer.addEventListener('play', () => {
      console.log(`audio played: ${audioSlug}`);
      window.umami.track('audio-played', {
        slug: audioSlug,
      })
    });

    audioPlayer.addEventListener('ended', () => {
      console.log(`audio ended: ${audioSlug}`);
      window.umami.track('audio-ended', {
        slug: audioSlug,
      })
    });
  }
</script>

<audio controls class="audio-player" data-slug={slug}>
    <source src={audioUrl} type="audio/mpeg">
    Votre navigateur ne supporte pas la balise audio.
</audio>